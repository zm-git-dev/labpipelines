
source $SLURM_ENTRY
wzref_hg38
pipeline_prepare

base=/mnt/isilon/zhou_lab/projects/20220408_Laudansky_RRBS/
cd $base

while read sid sname1 sname2 runname barcode; do

  sname=${sid}_${sname1}_${sname2}

  jump_comments
  pipeline_depend none
  
  fastq1=${runname}/${runname}_s_1_${barcode}.fastq.gz
  trim_galore_dir=trim
  days=2; memG=100; ppn=2      # 1-2h
  pipeline_eval 1 __zlab_trimGaloreSE_20211125

  # fastq1=trim/${sname}_R1_val_1.fq.gz
  # fastq2=trim/${sname}_R2_val_2.fq.gz
  # outdir=bam_biscuit
  # days=10; memG=110; ppn=12
  # pipeline_eval 11 __zlab_biscuitAlignStrandedPE_20220216

  # input=bam_biscuit/${sname}.bam
  # outdir=bam_biscuit_picard
  # days=2; memG=30; ppn=2        # 3h
  # pipeline_eval 12 __zlab_PicardMarkdup_20220219

  # in_bam=bam_biscuit_picard/${sname}.bam
  # out_bam=bam_biscuit_picard/${sname}.sorted.bam
  # days=1; memG=20; ppn=3        # 2-3h
  # pipeline_eval 13 __zlab_sortIndexBam_20211126

  # input=bam_biscuit_picard/${sname}.sorted.bam
  # outdir=pileup
  # days=1; memG=100; ppn=10
  # pipeline_eval 14 __zlab_biscuitPileup_20220219

  # input=pileup/${sname}_cg.bed.gz
  # outdir=pileup
  # days=1; memG=100; ppn=10
  # pipeline_eval 15 __zlab_convertBigwigCG_20220219

  # input=bam_biscuit_picard/${sname}.bam
  # outdir=BISCUITqc
  # days=2; memG=10; ppn=4
  # pipeline_eval 16 __zlab_biscuitQC_20220224
 
  # fastq1=trim/${sname}_R1_val_1.fq.gz
  # fastq2=trim/${sname}_R2_val_2.fq.gz
  # bam_dir=bam_bismarkbt2/${sname}
  # days=21; memG=500; ppn=24
  # pipeline_eval 31 __zlab_BismarkBt2StrandedPE_20220214

  # input=bam_bismarkbt2/${sname}.bam
  # outdir=bam_bismarkbt2_picard
  # days=2; memG=30; ppn=2        # 3h
  # pipeline_eval 32 __zlab_PicardMarkdup_20220219

  # in_bam=bam_bismarkbt2_picard/${sname}.bam
  # out_bam=bam_bismarkbt2_picard/${sname}.sorted.bam
  # days=1; memG=20; ppn=3        # 2-3h
  # pipeline_eval 33 __zlab_sortIndexBam_20211126
  
  # in_bam=bam_bismarkbt2_picard/${sname}.sorted.bam
  # outdir=bam_bismarkMeth
  # days=3; memG=100; ppn=10      # 4h
  # pipeline_eval 34 __zlab_BismarkMethExtract_20211125
  
  # # fastq=trim/$sname/${sname}_trimmed.fq.gz
  # # bam_dir=bam_bismarkbt2/$sname
  # # days=3; memG=500; ppn=24      # 12-24h
  # # pipeline_eval 32 __zlab_BismarkBt2SE_20211125
  
done << EOM
107588	EpiCPB-T_Cells	PtNo33+0hr	FGC2394	ACGGACTT
107589	EpiCPB-T_Cells	PtNo34+0hr	FGC2394	CTAAGACC
107590	EpiCPB-T_Cells	PtNo40+0hr	FGC2394	AACCGAAC
107591	EpiCPB-T_Cells	PtNo44+0hr	FGC2394	CCTTAGGT
107592	EpiCPB-T_Cells	PtNo68_+_0hr	FGC2394	CCTATACC
107593	EpiCPB-T_Cells	PtNo78_+_0hr	FGC2394	AACGCCTT
107594	EpiCPB-T_Cells	PtNo108+0hr	FGC2394	TCCATTGC
107595	EpiCPB-T_Cells	PtNo110+0hr	FGC2394	CAAGCCAA
107596	EpiCPB-T_Cells	PtNo111+0hr	FGC2394	AGGTTCCT
107597	EpiCPB-T_Cells	PtNo121_+_0hr	FGC2394	GAACCTTC
107598	EpiCPB-T_Cells	PtNo125_+_0hr	FGC2394	AAGTCCTC
107599	EpiCPB-T_Cells	PtNo137+0hr	FGC2394	CCACAACA
107600	EpiCPB-T_Cells	PtNo1+24hr	FGC2394	ATAACGCC
107601	EpiCPB-T_Cells	PtNo5+24hr	FGC2394	CCGGAATA
107602	EpiCPB-T_Cells	PtNo14_+24hr	FGC2394	CCAAGTAG
107603	EpiCPB-T_Cells	PtNo37+24hr	FGC2394	AAGGACCA
107604	EpiCPB-T_Cells	PtNo38+24hr	FGC2394	ACGCTTCT
107605	EpiCPB-T_Cells	PtNo72+24hr	FGC2394	CTATCCAC
107606	EpiCPB-T_Cells	PtNo103+24hr	FGC2394	TGACAACC
107607	EpiCPB-T_Cells	PtNo122+24hr_	FGC2394	CAGTGCTT
107608	EpiCPB-T_Cells	PtNo135+24hr	FGC2394	TCACTCGA
107609	EpiCPB-T_Cells	PtNo136+24hr	FGC2394	CTGACTAC
107610	EpiCPB-T_Cells	PtNo136+24hr	FGC2394	GTGATCCA
107611	EpiCPB-T_Cells	PtNo140+24hr_	FGC2394	ACAGCAAG
107612	EpiCPB-T_Cells	PtNo1+7d	FGC2394	TGCTGTGA
107613	EpiCPB-T_Cells	PtNo9+7d	FGC2394	CAACACAG
107614	EpiCPB-T_Cells	PtNo13+7d	FGC2394	CCACATTG
107615	EpiCPB-T_Cells	PtNo42_+_7d	FGC2394	TAGTGCCA
107616	EpiCPB-T_Cells	PtNo59+7d	FGC2394	TCGTGCAT
107617	EpiCPB-T_Cells	PtNo66+7d	FGC2394	CTACATCC
107618	EpiCPB-T_Cells	PtNo67+7d	FGC2394	CATACGGA
107619	EpiCPB-T_Cells	PtNo68+7d	FGC2394	TGCGTAAC
107620	EpiCPB-T_Cells	PtNo69_+_7d	FGC2394	CAGGTTCA
107621	EpiCPB-T_Cells	PtNo70_+_7d	FGC2394	AGAACCAG
107622	EpiCPB-T_Cells	PtNo71+7d	FGC2394	GAATGGCA
107623	EpiCPB-T_Cells	PtNo72+7d	FGC2394	AGGCAATG
107624	EpiCPB-T_Cells	PtNo6+3m	FGC2394	TAGGAGCT
107625	EpiCPB-T_Cells	PtNo22+3m	FGC2394	CGAACAAC
107626	EpiCPB-T_Cells	PtNo31+3m	FGC2394	CATTCGTC
107627	EpiCPB-T_Cells	PtNo32+3m	FGC2394	AGCCAACT
107628	EpiCPB-T_Cells	PtNo57+3m	FGC2394	GCCTTAAC
107629	EpiCPB-T_Cells	PtNo80_+_3m	FGC2394	ATTCCGCT
107630	EpiCPB-T_Cells	PtNo82_+_3m	FGC2394	ATCGTGGT
107631	EpiCPB-T_Cells	PtNo97+3m	FGC2394	GCTACAAC
107632	EpiCPB-T_Cells	PtNo102_+_3m	FGC2394	TCTACGCA
107633	EpiCPB-T_Cells	PtNo105_+_3m	FGC2394	CTCCAATC
107634	EpiCPB-T_Cells	PtNo108+3m	FGC2394	ACTCTCCA
107635	EpiCPB-T_Cells	PtNo110+3m	FGC2394	GTCTCATC
107636	PICOBS	4T1	FGC2394	GCCAGAAT
107637	PICOBS	4T3	FGC2394	AATGACGC
107638	PICOBS	4T4	FGC2394	GTACCACA
107639	PICOBS	14T1	FGC2394	ACGATCAG
107640	PICOBS	14T2	FGC2394	TAACGTCG
107641	PICOBS	14T3	FGC2394	CGCAACTA
107642	PICOBS	23T1	FGC2394	AACACTGG
107643	PICOBS	23T2	FGC2394	CCTGTCAA
107644	PICOBS	23T4	FGC2394	TCCTGGTA
107645	PICOBS	24T1	FGC2394	CATCAACC
107646	PICOBS	24T2	FGC2394	AGCAGACA
107647	PICOBS	24T4	FGC2394	GAAGACTG
107648	PICOBS	37T1	FGC2394	TCTAGTCC
107649	PICOBS	37T2	FGC2394	CTCGACTT
107650	PICOBS	37T3	FGC2394	CTAGCTCA
107651	PICOBS	37T4	FGC2394	TCCAACTG
107652	PICOBS	53T1	FGC2394	GACATCTC
107653	PICOBS	53T3	FGC2394	ACTGCACT
107654	PICOBS	53T4	FGC2394	GTTCCATG
107655	PICOBS	82T1	FGC2394	ACCAAGCA
107656	PICOBS	82T3	FGC2394	CTCTCAGA
107657	PICOBS	82T4	FGC2394	ACTCTGAG
107658	PICOBS	83T3	FGC2394	GCTCAGTT
107659	PICOBS	83T4	FGC2394	ATCTGACC
107660	PICOBS	91T1	FGC2394	AACCAG
107661	PICOBS	91T2	FGC2394	TGGTGA
107662	PICOBS	91T3	FGC2394	AGTGAG
107663	PICOBS	91T4	FGC2394	GCACTA
107664	PICOBS	10T1	FGC2394	ACCTCA
107665	PICOBS	10T4	FGC2394	GTGCTT
107666	PICOBS	13T1	FGC2394	AAGCCT
107667	PICOBS	35T2	FGC2394	GTCGTA
107668	PICOBS	35T3	FGC2394	AAGAGG
107669	PICOBS	35T4	FGC2394	GGAGAA
107670	PICOBS	51T1	FGC2394	AGCATG
107671	PICOBS	51T3	FGC2394	GAGTCA
107672	PICOBS	56T2	FGC2394	CGTAGA
107673	PICOBS	56T3	FGC2394	TCAGAG
107674	PICOBS	86T1	FGC2394	CACAGT
107675	PICOBS	86T3	FGC2394	TTGGCA
107676	PICOBS	10T3	FGC2394	CGACCTAA
107677	PICOBS	13T2	FGC2394	ACGAGAAC
107678	PICOBS	13T3	FGC2394	GTACACCT
107679	PICOBS	35T1	FGC2394	CCAACACT
107680	PICOBS	51T4	FGC2394	CTCGAACA
107681	PICOBS	56T1	FGC2394	TCTAGGAG
107682	PICOBS	65T4	FGC2394	TACATCGG
107683	PICOBS	86T2	FGC2394	ATCGTCTC
107588	EpiCPB-T_Cells	PtNo33+0hr	FGC2360	ACGGACTT
107589	EpiCPB-T_Cells	PtNo34+0hr	FGC2360	CTAAGACC
107590	EpiCPB-T_Cells	PtNo40+0hr	FGC2360	AACCGAAC
107591	EpiCPB-T_Cells	PtNo44+0hr	FGC2360	CCTTAGGT
107592	EpiCPB-T_Cells	PtNo68_+_0hr	FGC2360	CCTATACC
107593	EpiCPB-T_Cells	PtNo78_+_0hr	FGC2360	AACGCCTT
107594	EpiCPB-T_Cells	PtNo108+0hr	FGC2360	TCCATTGC
107595	EpiCPB-T_Cells	PtNo110+0hr	FGC2360	CAAGCCAA
107596	EpiCPB-T_Cells	PtNo111+0hr	FGC2360	AGGTTCCT
107597	EpiCPB-T_Cells	PtNo121_+_0hr	FGC2360	GAACCTTC
107598	EpiCPB-T_Cells	PtNo125_+_0hr	FGC2360	AAGTCCTC
107599	EpiCPB-T_Cells	PtNo137+0hr	FGC2360	CCACAACA
107600	EpiCPB-T_Cells	PtNo1+24hr	FGC2360	ATAACGCC
107601	EpiCPB-T_Cells	PtNo5+24hr	FGC2360	CCGGAATA
107602	EpiCPB-T_Cells	PtNo14_+24hr	FGC2360	CCAAGTAG
107603	EpiCPB-T_Cells	PtNo37+24hr	FGC2360	AAGGACCA
107604	EpiCPB-T_Cells	PtNo38+24hr	FGC2360	ACGCTTCT
107605	EpiCPB-T_Cells	PtNo72+24hr	FGC2360	CTATCCAC
107606	EpiCPB-T_Cells	PtNo103+24hr	FGC2360	TGACAACC
107607	EpiCPB-T_Cells	PtNo122+24hr_	FGC2360	CAGTGCTT
107608	EpiCPB-T_Cells	PtNo135+24hr	FGC2360	TCACTCGA
107609	EpiCPB-T_Cells	PtNo136+24hr	FGC2360	CTGACTAC
107610	EpiCPB-T_Cells	PtNo136+24hr	FGC2360	GTGATCCA
107611	EpiCPB-T_Cells	PtNo140+24hr_	FGC2360	ACAGCAAG
107612	EpiCPB-T_Cells	PtNo1+7d	FGC2360	TGCTGTGA
107613	EpiCPB-T_Cells	PtNo9+7d	FGC2360	CAACACAG
107614	EpiCPB-T_Cells	PtNo13+7d	FGC2360	CCACATTG
107615	EpiCPB-T_Cells	PtNo42_+_7d	FGC2360	TAGTGCCA
107616	EpiCPB-T_Cells	PtNo59+7d	FGC2360	TCGTGCAT
107617	EpiCPB-T_Cells	PtNo66+7d	FGC2360	CTACATCC
107618	EpiCPB-T_Cells	PtNo67+7d	FGC2360	CATACGGA
107619	EpiCPB-T_Cells	PtNo68+7d	FGC2360	TGCGTAAC
107620	EpiCPB-T_Cells	PtNo69_+_7d	FGC2360	CAGGTTCA
107621	EpiCPB-T_Cells	PtNo70_+_7d	FGC2360	AGAACCAG
107622	EpiCPB-T_Cells	PtNo71+7d	FGC2360	GAATGGCA
107623	EpiCPB-T_Cells	PtNo72+7d	FGC2360	AGGCAATG
107624	EpiCPB-T_Cells	PtNo6+3m	FGC2360	TAGGAGCT
107625	EpiCPB-T_Cells	PtNo22+3m	FGC2360	CGAACAAC
107626	EpiCPB-T_Cells	PtNo31+3m	FGC2360	CATTCGTC
107627	EpiCPB-T_Cells	PtNo32+3m	FGC2360	AGCCAACT
107628	EpiCPB-T_Cells	PtNo57+3m	FGC2360	GCCTTAAC
107629	EpiCPB-T_Cells	PtNo80_+_3m	FGC2360	ATTCCGCT
107630	EpiCPB-T_Cells	PtNo82_+_3m	FGC2360	ATCGTGGT
107631	EpiCPB-T_Cells	PtNo97+3m	FGC2360	GCTACAAC
107632	EpiCPB-T_Cells	PtNo102_+_3m	FGC2360	TCTACGCA
107633	EpiCPB-T_Cells	PtNo105_+_3m	FGC2360	CTCCAATC
107634	EpiCPB-T_Cells	PtNo108+3m	FGC2360	ACTCTCCA
107635	EpiCPB-T_Cells	PtNo110+3m	FGC2360	GTCTCATC
107636	PICOBS	4T1	FGC2360	GCCAGAAT
107637	PICOBS	4T3	FGC2360	AATGACGC
107638	PICOBS	4T4	FGC2360	GTACCACA
107639	PICOBS	14T1	FGC2360	ACGATCAG
107640	PICOBS	14T2	FGC2360	TAACGTCG
107641	PICOBS	14T3	FGC2360	CGCAACTA
107642	PICOBS	23T1	FGC2360	AACACTGG
107643	PICOBS	23T2	FGC2360	CCTGTCAA
107644	PICOBS	23T4	FGC2360	TCCTGGTA
107645	PICOBS	24T1	FGC2360	CATCAACC
107646	PICOBS	24T2	FGC2360	AGCAGACA
107647	PICOBS	24T4	FGC2360	GAAGACTG
107648	PICOBS	37T1	FGC2360	TCTAGTCC
107649	PICOBS	37T2	FGC2360	CTCGACTT
107650	PICOBS	37T3	FGC2360	CTAGCTCA
107651	PICOBS	37T4	FGC2360	TCCAACTG
107652	PICOBS	53T1	FGC2360	GACATCTC
107653	PICOBS	53T3	FGC2360	ACTGCACT
107654	PICOBS	53T4	FGC2360	GTTCCATG
107655	PICOBS	82T1	FGC2360	ACCAAGCA
107656	PICOBS	82T3	FGC2360	CTCTCAGA
107657	PICOBS	82T4	FGC2360	ACTCTGAG
107658	PICOBS	83T3	FGC2360	GCTCAGTT
107659	PICOBS	83T4	FGC2360	ATCTGACC
107660	PICOBS	91T1	FGC2360	AACCAG
107661	PICOBS	91T2	FGC2360	TGGTGA
107662	PICOBS	91T3	FGC2360	AGTGAG
107663	PICOBS	91T4	FGC2360	GCACTA
107664	PICOBS	10T1	FGC2360	ACCTCA
107665	PICOBS	10T4	FGC2360	GTGCTT
107666	PICOBS	13T1	FGC2360	AAGCCT
107667	PICOBS	35T2	FGC2360	GTCGTA
107668	PICOBS	35T3	FGC2360	AAGAGG
107669	PICOBS	35T4	FGC2360	GGAGAA
107670	PICOBS	51T1	FGC2360	AGCATG
107671	PICOBS	51T3	FGC2360	GAGTCA
107672	PICOBS	56T2	FGC2360	CGTAGA
107673	PICOBS	56T3	FGC2360	TCAGAG
107674	PICOBS	86T1	FGC2360	CACAGT
107675	PICOBS	86T3	FGC2360	TTGGCA
107676	PICOBS	10T3	FGC2360	CGACCTAA
107677	PICOBS	13T2	FGC2360	ACGAGAAC
107678	PICOBS	13T3	FGC2360	GTACACCT
107679	PICOBS	35T1	FGC2360	CCAACACT
107680	PICOBS	51T4	FGC2360	CTCGAACA
107681	PICOBS	56T1	FGC2360	TCTAGGAG
107682	PICOBS	65T4	FGC2360	TACATCGG
107683	PICOBS	86T2	FGC2360	ATCGTCTC
EOM
